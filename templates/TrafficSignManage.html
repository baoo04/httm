<html>
  <body>
    <h1>Traffic Sign Model Management</h1>

    <table border="1">
      <tr>
        <th>Name</th>
        <th>Version</th>
        <th>Precision</th>
        <th>Recall</th>
        <th>Action</th>
      </tr>
      {% for m in models %}
      <tr>
        <td>{{ m.name }}</td>
        <td>{{ m.version }}</td>
        <td>{{ m.pre }}</td>
        <td>{{m.recall}}</td>
        <td><button onclick="retrain()">Retrain</button></td>
      </tr>
      {% endfor %}
    </table>

    <div id="result" style="margin-top: 20px; display: none">
      <h3>Retrain Result</h3>
      <p><b>Name:</b> <span id="modelName"></span></p>
      <p><b>Precision:</b> <span id="modelPrecision"></span></p>
      <p><b>Path:</b> <span id="modelPath"></span></p>
      <button onclick="saveModel()">Save Model</button>
    </div>

    <script>
      let currentModel = null;

      function retrain() {
        fetch("/retrain", { method: "POST" })
          .then((r) => r.json())
          .then((data) => {
            currentModel = data;
            document.getElementById("modelName").innerText = data.name;
            document.getElementById("modelPrecision").innerText =
              data.precision;
            document.getElementById("modelPath").innerText = data.path;
            document.getElementById("result").style.display = "block";
          });
      }

      function saveModel() {
        if (!currentModel) return alert("No model to save!");
        fetch("/save_model", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(currentModel),
        })
          .then((r) => r.json())
          .then((data) => alert(data.message));
      }
    </script>
  </body>
</html>
